<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="/js/jquery-2.1.1.min.js"></script>
    <link rel="stylesheet" href="/js/easyui1.5/themes/icon.css">
    <link rel="stylesheet" href="/js/easyui1.5/themes/default/easyui.css">
    <script src="/js/easyui1.5/jquery.easyui.min.js"></script>
    <script src="/js/easyui1.5/locale/easyui-lang-zh_CN.js"></script>

    <script type="text/javascript" th:inline="none">

       $(function(){


           initPinglun();
       })




        function  initPinglun(){

           $('#pinglun').datagrid({

              url:'/pingLun/queryPingLun',
               pagination:true,
               pageList:[1,3,5,9],
               pageSize:3,
               loadMsg:'正在加载,别着急',
               columns:[[
                   {field:'id',title:'Id'},
                   {field:'yh_mch',title:'用户名称'},
                   {field:'plnr',title:'评论内容'},
                   {field:'plshj',title:'评论时间',formatter:function(value,row,index){
                           var date = new Date(value);
                           return date.toLocaleDateString();
                       }},
                   {field:'hpjb',title:'好评级别'},
                    {field:'sku_mch',title:'sku名称'},
                    {field:'shp_mch',title:'商品名称'},
                   {field:'status',title:'状态',formatter:function (value,row,index) {
                           return value==0?"未审查":""+value==1?"审查通过":""+value==2?"不通过":"";
                       }},
                   {field:'123',title:'操作',formatter:function(value,row,index){

                           if(row.status==0){

                               var  content="<a href='javascript:void(0)'  onclick=editPinglun("+row.id+")>不通过</a>";
                                content+="<a href='javascript:void(0)'  onclick=delOne("+row.id+")>删除</a>";

                           }else if(row.status==2){

                               var  content="<a href='javascript:void(0)' onclick=edittongguo("+row.id+")>通过</a>";
                                content+="<a href='javascript:void(0)'  onclick=delOne("+row.id+")>删除</a>";
                           }else if (row.status==1) {
                               var  content="<a href='javascript:void(0)'  onclick=delOne("+row.id+")>删除</a>";
                           }

                           return content;
                       }}
               ]]
           })
        }



       function editPinglun(id){

           $.ajax({
               url:"/pingLun/updatePinglun",
               type:"POST",
               data:{"id":id},
               success:function(data){

                   if(data == 1){

                      alert("操作成功");
                       location.reload();
                   }else{

                       alert("操作失败");
                   }

               },
               error:function(){
                   alert("ajax访问失败了,查看控制台");
               }
           });

       }

       function edittongguo(id){

           $.ajax({
               url:"/pingLun/updateTongguo",
               type:"POST",
               data:{"id":id},
               success:function(data){

                   if(data == 1){

                       alert("操作成功");
                       location.reload();
                   }else{

                       alert("操作失败");
                   }

               },
               error:function(){
                   alert("ajax访问失败了,查看控制台");
               }
           });
       }

       function delOne(id){
           $.messager.confirm('提示','你确定要删除这条数据吗？',function(r){
               if(r){
                   $.ajax({
                       url:'/pingLun/deletePingLun',
                       type:'post',
                       data:{"id":id},
                       dataType:'json',
                       success:function(data){
                           if (data==1) {
                               window.location.reload();
                           }else{
                               $.messager.alert('提示','删除失败','warning');
                           }
                       }
                   })
               }
           })
       }




    </script>
</head>
<body>
    <table id="pinglun"></table>
</body>
</html>